# ‚öôÔ∏è –í–∞—Ä–∏–∞–Ω—Ç—ã –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –≤ Celery: `prefork`, `gevent`, `eventlet`

–í Celery –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –ø—É–ª–æ–≤ –≤–æ—Ä–∫–µ—Ä–æ–≤: `prefork`, `gevent` –∏ `eventlet`. –ö–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∑–∞–¥–∞—á –∏ –ø–æ-—Ä–∞–∑–Ω–æ–º—É —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–æ–º.

---
### 1. [–†–µ–∑—É–ª—å—Ç–∞—Ç prefork](prefork/REPORT.md)
### 2. [–†–µ–∑—É–ª—å—Ç–∞—Ç gevent](gevent/REPORT.md)
### 3. [–†–µ–∑—É–ª—å—Ç–∞—Ç eventlet](eventlet/REPORT.md)

## üîÑ –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ú–æ–¥–µ–ª—å     | –¢–∏–ø                | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å | –õ—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è   | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RAM | –ò–∑–æ–ª—è—Ü–∏—è –∑–∞–¥–∞—á | –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å | –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏ I/O | –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏ CPU |
| ---------- | ------------------ | ------------- | -------------------------- | ----------------- | -------------- | ---------- | ---------------- | ---------------- |
| `prefork`  | –ù–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö       | ‚ùå             | **CPU-–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏** | ‚ö†Ô∏è –í—ã—Å–æ–∫–æ–µ        | ‚úÖ –í—ã—Å–æ–∫–∞—è      | ‚úÖ –í—ã—Å–æ–∫–∞—è  | üòê –°—Ä–µ–¥–Ω—è—è       | ‚úÖ –õ—É—á—à–∞—è         |
| `gevent`   | –ù–∞ –∫–æ—Ä—É—Ç–∏–Ω–∞—Ö       | ‚úÖ             | **–°–µ—Ç–µ–≤—ã–µ (I/O) –∑–∞–¥–∞—á–∏**   | ‚úÖ –ù–∏–∑–∫–æ–µ          | ‚ùå –ù–∏–∑–∫–∞—è       | ‚ùå –†–∏—Å–∫–æ–≤–∞—è | ‚úÖ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è  | ‚ùå –ü–ª–æ—Ö–∞—è         |
| `eventlet` | –ù–∞ green thread'–∞—Ö | ‚úÖ             | **–ü—Ä–æ—Å—Ç—ã–µ I/O –∑–∞–¥–∞—á–∏**     | ‚úÖ –ù–∏–∑–∫–æ–µ          | ‚ùå –ù–∏–∑–∫–∞—è       | ‚ùå –†–∏—Å–∫–æ–≤–∞—è | üòê –°—Ä–µ–¥–Ω—è—è       | ‚ùå –ü–ª–æ—Ö–∞—è         |

---

## üìå –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

### üßµ `prefork`

* –ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º **–ø—Ä–æ—Ü–µ—Å—Å–µ**.
* –ù–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω GIL (Global Interpreter Lock).
* –ü—Ä–æ—Ü–µ—Å—Å—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ ‚Äî —Å–±–æ–π –≤ –æ–¥–Ω–æ–º –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è:**

> –¢—è–∂—ë–ª—ã—Ö –ø–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É –∑–∞–¥–∞—á: –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞, ML, NumPy, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ —Ç.–ø.

---

### üåø `gevent`

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **greenlet** (–ª—ë–≥–∫–∏–µ –∫–æ—Ä—É—Ç–∏–Ω—ã).
* –†–∞–±–æ—Ç–∞–µ—Ç —Å `monkey_patch()`, —á—Ç–æ–±—ã –∑–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ.
* –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–¥–∞—á.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è:**

> –ú–∞—Å—Å–æ–≤—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤, —Ä–∞–±–æ—Ç—ã —Å Redis, WebSocket, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, API-–≥–µ–π—Ç–≤–µ–µ–≤ –∏ –ø—Ä–æ—á–µ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ I/O.

---

### üå± `eventlet`

* –ü–æ—Ö–æ–∂ –Ω–∞ `gevent`, –Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∏–∂–µ.
* –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `gunicorn`, `flask-socketio`.
* –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –∏–ª–∏ –Ω–µ—Å–ª–æ–∂–Ω—ã—Ö I/O –∑–∞–¥–∞—á.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è:**

> –ú–∞–ª–µ–Ω—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏, –≥–¥–µ –≤–∞–∂–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å.

---

## ‚úÖ –ö–æ–≥–¥–∞ –∏ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

| –°—Ü–µ–Ω–∞—Ä–∏–π / –ó–∞–¥–∞—á–∞                       | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø—É–ª       |
| --------------------------------------- | ----------------------- |
| –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∏–¥–µ–æ –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π       | `prefork`               |
| –ú–∞—Å—Å–æ–≤—ã–µ HTTP API-–∑–∞–ø—Ä–æ—Å—ã               | `gevent` –∏–ª–∏ `eventlet` |
| –ß–∞—Å—Ç—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ Redis –∏–ª–∏ PostgreSQL | `gevent`                |
| –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ –∏–∑–æ–ª—è—Ü–∏—è –∑–∞–¥–∞—á   | `prefork`               |
| –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã, –Ω–æ –º–Ω–æ–≥–æ –∑–∞–¥–∞—á    | `gevent` –∏–ª–∏ `eventlet` |

---

